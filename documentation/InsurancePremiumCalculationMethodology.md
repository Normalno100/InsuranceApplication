# üöÄ –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç—Ä–∞—Ö–æ–≤—ã—Ö –ø—Ä–µ–º–∏–π

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
3. –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
5. –î–µ–ø–ª–æ–π
6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

---

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è

#### 1. –ù–æ–≤—ã–µ Enum'—ã
- ‚úÖ `MedicalRiskLimitLevel` - —É—Ä–æ–≤–Ω–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è
- ‚úÖ `Country` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å—Ç—Ä–∞–Ω —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏
- ‚úÖ `RiskType` - —Ç–∏–ø—ã —Å—Ç—Ä–∞—Ö–æ–≤—ã—Ö —Ä–∏—Å–∫–æ–≤

#### 2. –ù–æ–≤—ã–µ DTO
- ‚úÖ `TravelCalculatePremiumRequestV2` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- ‚úÖ `TravelCalculatePremiumResponseV2` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –¥–µ—Ç–∞–ª—è–º–∏

#### 3. –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã
- ‚úÖ `AgeCalculator` - —Ä–∞—Å—á–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞ –∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
- ‚úÖ `MedicalRiskPremiumCalculator` - –≥–ª–∞–≤–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø—Ä–µ–º–∏–∏

#### 4. –°–µ—Ä–≤–∏—Å—ã
- ‚úÖ `PromoCodeService` - —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–º–æ-–∫–æ–¥–∞–º–∏
- ‚úÖ `DiscountService` - –≥—Ä—É–ø–ø–æ–≤—ã–µ –∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–∫–∏–¥–∫–∏
- ‚úÖ `CurrencyExchangeService` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∞–ª—é—Ç
- ‚úÖ `TravelCalculatePremiumServiceV2` - –≥–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å

#### 5. REST API
- ‚úÖ `TravelCalculatePremiumControllerV2` - –Ω–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä v2

#### 6. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ 15 –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü
- ‚úÖ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∏ –±–∏–∑–Ω–µ—Å-—Ç–∞–±–ª–∏—Ü—ã
- ‚úÖ –ê—É–¥–∏—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠–¢–ê–ü 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (1-2 –¥–Ω—è)

#### 1.1 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# 1. –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
# –í build.gradle –¥–æ–±–∞–≤–∏—Ç—å:
implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
implementation 'org.postgresql:postgresql:42.6.0'
implementation 'org.liquibase:liquibase-core:4.24.0'

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ë–î
# application.properties
spring.datasource.url=jdbc:postgresql://localhost:5432/travel_insurance
spring.datasource.username=postgres
spring.datasource.password=postgres
spring.jpa.hibernate.ddl-auto=validate
spring.liquibase.enabled=true
```

#### 1.2 –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–∫–µ—Ç–æ–≤
```
src/main/java/org/javaguru/travel/insurance/
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ domain/              # Enum'—ã
‚îÇ   ‚îú‚îÄ‚îÄ calculators/         # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ services/            # –ë–∏–∑–Ω–µ—Å-—Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îî‚îÄ‚îÄ validation/          # –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã
‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îî‚îÄ‚îÄ v2/                  # DTO –≤–µ—Ä—Å–∏–∏ 2
‚îú‚îÄ‚îÄ rest/
‚îÇ   ‚îî‚îÄ‚îÄ v2/                  # REST –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã v2
‚îî‚îÄ‚îÄ repository/              # JPA —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
```

---

### –≠–¢–ê–ü 2: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (2-3 –¥–Ω—è)

#### 2.1 –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ Liquibase

**–§–∞–π–ª: `src/main/resources/db/changelog/db.changelog-master.yaml`**
```yaml
databaseChangeLog:
  - include:
      file: db/changelog/001_create_reference_tables.sql
  - include:
      file: db/changelog/002_create_business_tables.sql
  - include:
      file: db/changelog/003_create_indexes.sql
  - include:
      file: db/changelog/004_insert_initial_data.sql
```

#### 2.2 –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
./gradlew liquibaseUpdate

# Prod (–ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
./gradlew liquibaseUpdate -Penv=prod
```

#### 2.3 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public';

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
SELECT COUNT(*) FROM age_coefficients;
SELECT COUNT(*) FROM countries;
SELECT COUNT(*) FROM risk_types;
```

---

### –≠–¢–ê–ü 3: Enum'—ã –∏ Domain –º–æ–¥–µ–ª–∏ (1 –¥–µ–Ω—å)

#### 3.1 –°–æ–∑–¥–∞—Ç—å Enum'—ã
- ‚úÖ `MedicalRiskLimitLevel.java`
- ‚úÖ `Country.java`
- ‚úÖ `RiskType.java`

#### 3.2 –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è Enum'–æ–≤
```java
@DisplayName("MedicalRiskLimitLevel Tests")
class MedicalRiskLimitLevelTest {
    
    @Test
    void shouldFindLevelByCode() {
        assertEquals(
            MedicalRiskLimitLevel.LEVEL_50000,
            MedicalRiskLimitLevel.fromCode("50000")
        );
    }
    
    @Test
    void shouldFindLevelByAmount() {
        assertEquals(
            MedicalRiskLimitLevel.LEVEL_50000,
            MedicalRiskLimitLevel.findByAmount(new BigDecimal("45000"))
        );
    }
}
```

**–¶–µ–ª—å:** –ú–∏–Ω–∏–º—É–º 20 —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –∫–∞–∂–¥—ã–π Enum

---

### –≠–¢–ê–ü 4: –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã (3-4 –¥–Ω—è)

#### 4.1 –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å AgeCalculator
```java
@Component
public class AgeCalculator {
    public int calculateAge(LocalDate birthDate, LocalDate referenceDate);
    public BigDecimal getAgeCoefficient(int age);
    public AgeCalculationResult calculateAgeAndCoefficient();
}
```

**–¢–µ—Å—Ç—ã (–º–∏–Ω–∏–º—É–º 30):**
- –†–∞—Å—á–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –¥–∞—Ç
- –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–ª—è –≤—Å–µ—Ö –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –≥—Ä—É–ø–ø
- –ì—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è

#### 4.2 –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å MedicalRiskPremiumCalculator
```java
@Component
public class MedicalRiskPremiumCalculator {
    public BigDecimal calculatePremium(TravelCalculatePremiumRequestV2);
    public PremiumCalculationResult calculatePremiumWithDetails();
}
```

**–¢–µ—Å—Ç—ã (–º–∏–Ω–∏–º—É–º 50):**
- –†–∞—Å—á–µ—Ç –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º—É–ª—ã
- –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ
- –î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞

---

### –≠–¢–ê–ü 5: –°–µ—Ä–≤–∏—Å—ã —Å–∫–∏–¥–æ–∫ –∏ –ø—Ä–æ–º–æ-–∫–æ–¥–æ–≤ (2-3 –¥–Ω—è)

#### 5.1 PromoCodeService
```java
@Service
public class PromoCodeService {
    public PromoCodeResult applyPromoCode(...);
    private ValidationResult validatePromoCode(...);
    private BigDecimal calculateDiscount(...);
}
```

**–¢–µ—Å—Ç—ã (–º–∏–Ω–∏–º—É–º 40):**
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤–∞–ª–∏–¥–Ω–æ–≥–æ –ø—Ä–æ–º–æ-–∫–æ–¥–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–∏–æ–¥–∞ –¥–µ–π—Å—Ç–≤–∏—è
- –õ–∏–º–∏—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–∏–¥–∫–∞

#### 5.2 DiscountService
```java
@Service
public class DiscountService {
    public List<DiscountResult> calculateApplicableDiscounts(...);
    public Optional<DiscountResult> calculateBestDiscount(...);
}
```

**–¢–µ—Å—Ç—ã (–º–∏–Ω–∏–º—É–º 35):**
- –ì—Ä—É–ø–ø–æ–≤—ã–µ —Å–∫–∏–¥–∫–∏
- –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–∫–∏–¥–∫–∏
- –°–µ–∑–æ–Ω–Ω—ã–µ —Å–∫–∏–¥–∫–∏
- –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–∏–¥–æ–∫

---

### –≠–¢–ê–ü 6: –ì–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å –∏ API (3-4 –¥–Ω—è)

#### 6.1 TravelCalculatePremiumServiceV2
```java
@Service
public class TravelCalculatePremiumServiceV2 {
    public TravelCalculatePremiumResponseV2 calculatePremium(
        TravelCalculatePremiumRequestV2 request
    );
}
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**
1. –í–∞–ª–∏–¥–∞—Ü–∏—è ‚Üí 2. –†–∞—Å—á–µ—Ç ‚Üí 3. –ü—Ä–æ–º–æ-–∫–æ–¥—ã ‚Üí 4. –°–∫–∏–¥–∫–∏ ‚Üí 5. –û—Ç–≤–µ—Ç

**–¢–µ—Å—Ç—ã (–º–∏–Ω–∏–º—É–º 60):**
- Happy path —Å—Ü–µ–Ω–∞—Ä–∏–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—à–∏–±–æ–∫
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–æ-–∫–æ–¥–æ–≤
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–∫–∏–¥–æ–∫
- –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏

#### 6.2 REST API v2
```java
@RestController
@RequestMapping("/insurance/travel/v2")
public class TravelCalculatePremiumControllerV2 {
    @PostMapping("/calculate")
    public ResponseEntity<TravelCalculatePremiumResponseV2> calculatePremium(...);
}
```

**–¢–µ—Å—Ç—ã (–º–∏–Ω–∏–º—É–º 25):**
- –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è JSON
- HTTP —Å—Ç–∞—Ç—É—Å—ã
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

### –≠–¢–ê–ü 7: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (2-3 –¥–Ω—è)

#### 7.1 End-to-End —Ç–µ—Å—Ç—ã
```java
@SpringBootTest
@AutoConfigureMockMvc
class TravelInsuranceE2ETest {
    
    @Test
    void shouldCalculateComplexPremium() {
        // Given: —Å–ª–æ–∂–Ω—ã–π –∑–∞–ø—Ä–æ—Å
        // When: –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ /v2/calculate
        // Then: –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
    }
}
```

**–°—Ü–µ–Ω–∞—Ä–∏–∏ (–º–∏–Ω–∏–º—É–º 20):**
- –ü—Ä–æ—Å—Ç–æ–π –æ—Ç–ø—É—Å–∫ –≤ –ï–≤—Ä–æ–ø–µ
- –ì–æ—Ä–Ω–æ–ª—ã–∂–Ω—ã–π —Ç—É—Ä
- –≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ
- –ü–æ–∂–∏–ª–æ–π —Ç—É—Ä–∏—Å—Ç
- –ì—Ä—É–ø–ø–æ–≤–∞—è –ø–æ–µ–∑–¥–∫–∞
- –° –ø—Ä–æ–º–æ-–∫–æ–¥–æ–º
- –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –∫–ª–∏–µ–Ω—Ç

#### 7.2 Performance —Ç–µ—Å—Ç—ã
```java
@Test
void shouldHandleHighLoad() {
    // 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 10 —Å–µ–∫—É–Ω–¥
    // –°—Ä–µ–¥–Ω–∏–π response time < 200ms
}
```

---

### –≠–¢–ê–ü 8: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (1-2 –¥–Ω—è)

#### 8.1 API Documentation (OpenAPI/Swagger)
```yaml
openapi: 3.0.0
info:
  title: Travel Insurance API v2
  version: 2.0.0
paths:
  /insurance/travel/v2/calculate:
    post:
      summary: Calculate insurance premium
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CalculateRequest'
```

#### 8.2 User Guide
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
- –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π
- –ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å—á–µ—Ç–æ–≤
- FAQ

#### 8.3 Developer Guide
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è
- –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä–∞–Ω—É
- –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
- –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø —Ä–∏—Å–∫–∞

---

## –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

#### –í–∞—Ä–∏–∞–Ω—Ç 1: Blue-Green Deployment
```
1. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é (v2) –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
2. –ù–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã ‚Üí v2
3. –°—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã ‚Üí v1 (deprecated)
4. –ß–µ—Ä–µ–∑ 3 –º–µ—Å—è—Ü–∞: –æ—Ç–∫–ª—é—á–∏—Ç—å v1
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
```
1. v1 –∏ v2 —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
2. Feature flag –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
3. A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥
```

### –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

#### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã
```sql
-- Liquibase —Å–æ–∑–¥–∞—Å—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
-- –î–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è
```

#### –®–∞–≥ 2: –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
```sql
-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –º–∏–≥—Ä–∞—Ü–∏–π
INSERT INTO countries ...
INSERT INTO age_coefficients ...
INSERT INTO risk_types ...
```

#### –®–∞–≥ 3: –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```sql
-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ç–∞—Ä—ã—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –≤ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
INSERT INTO persons (first_name, last_name, birth_date)
SELECT DISTINCT person_first_name, person_last_name, '1990-01-01'
FROM old_agreements;
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç             | Unit Tests  | Integration Tests  | Total   |
|-----------------------|-------------|--------------------|---------|
| Enum'—ã                | 60          | -                  | 60      |
| AgeCalculator         | 30          | -                  | 30      |
| MedicalRiskCalculator | 50          | -                  | 50      |
| PromoCodeService      | 40          | -                  | 40      |
| DiscountService       | 35          | -                  | 35      |
| Main Service          | 60          | 20                 | 80      |
| REST API              | 25          | 20                 | 45      |
| **–ò–¢–û–ì–û**             | **300**     | **40**             | **340** |

### –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### Week 1: Unit Tests
- –î–µ–Ω—å 1-2: Enum'—ã –∏ Domain
- –î–µ–Ω—å 3-4: –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã
- –î–µ–Ω—å 5: –°–µ—Ä–≤–∏—Å—ã

#### Week 2: Integration Tests
- –î–µ–Ω—å 1-2: API —Ç–µ—Å—Ç—ã
- –î–µ–Ω—å 3: E2E —Å—Ü–µ–Ω–∞—Ä–∏–∏
- –î–µ–Ω—å 4: Performance
- –î–µ–Ω—å 5: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## –î–µ–ø–ª–æ–π

### Checklist –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (340/340)
- [ ] Code coverage > 85%
- [ ] –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤ –≤ Sonar
- [ ] API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –Ω–∞ staging
- [ ] Rollback plan –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –ê–ª–µ—Ä—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

### –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

#### 1. Staging
```bash
# 1. Deploy –Ω–∞ staging
./deploy.sh staging

# 2. Smoke tests
./run_smoke_tests.sh staging

# 3. Full regression
./run_regression_tests.sh staging
```

#### 2. Production
```bash
# 1. Blue-Green deployment
./deploy.sh production --blue-green

# 2. Health check
curl https://api.travel-insurance.com/v2/health

# 3. Monitor
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ 30 –º–∏–Ω—É—Ç
# –ï—Å–ª–∏ OK ‚Üí switch traffic
# –ï—Å–ª–∏ –Ω–µ OK ‚Üí rollback
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

#### 1. Performance
- Response time (p50, p95, p99)
- Throughput (requests/sec)
- Error rate

#### 2. Business Metrics
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å—á–µ—Ç–æ–≤
- –°—Ä–µ–¥–Ω—è—è –ø—Ä–µ–º–∏—è
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–æ-–∫–æ–¥–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫–∏–¥–æ–∫

#### 3. –ê–ª–µ—Ä—Ç—ã
```yaml
alerts:
  - name: high_error_rate
    condition: error_rate > 5%
    severity: critical
  
  - name: slow_response
    condition: p95_response_time > 500ms
    severity: warning
  
  - name: database_connection
    condition: connection_errors > 0
    severity: critical
```

### Dashboard

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Travel Insurance V2 - Real-time Dashboard  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                             ‚îÇ
‚îÇ  Requests/sec:  [=====>    ] 127            ‚îÇ
‚îÇ  Avg Response:  [===>      ] 143ms          ‚îÇ
‚îÇ  Error Rate:    [          ] 0.2%           ‚îÇ
‚îÇ  Success Rate:  [=========>] 99.8%          ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  Top Countries: ES (34%), DE (21%), FR...   ‚îÇ
‚îÇ  Promo Codes:   SUMMER2025 (67 uses)        ‚îÇ
‚îÇ  Avg Premium:   ‚Ç¨234.56                     ‚îÇ
‚îÇ                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

| –≠—Ç–∞–ø                  | –í—Ä–µ–º—è      | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ           |
|-----------------------|------------|----------------------|
| 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞         | 2 –¥–Ω—è      | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è  |
| 2. –ë–î                 | 3 –¥–Ω—è      | –ú–∏–≥—Ä–∞—Ü–∏–∏ + —Ç–µ—Å—Ç—ã     |
| 3. Enum'—ã             | 1 –¥–µ–Ω—å     | + unit tests         |
| 4. –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã       | 4 –¥–Ω—è      | + –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ    |
| 5. –°–µ—Ä–≤–∏—Å—ã            | 3 –¥–Ω—è      | –ü—Ä–æ–º–æ-–∫–æ–¥—ã, —Å–∫–∏–¥–∫–∏   |
| 6. Main Service + API | 4 –¥–Ω—è      | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è           |
| 7. Integration Tests  | 3 –¥–Ω—è      | E2E + performance    |
| 8. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è       | 2 –¥–Ω—è      | API + guides         |
| 9. –î–µ–ø–ª–æ–π             | 2 –¥–Ω—è      | Staging + production |
| **–ò–¢–û–ì–û**             | **24 –¥–Ω—è** | ~1 –º–µ—Å—è—Ü —Ä–∞–±–æ—Ç—ã      |

---

## –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

| –†–∏—Å–∫                    | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å   | –í–ª–∏—è–Ω–∏–µ     | –ú–∏—Ç–∏–≥–∞—Ü–∏—è                          |
|-------------------------|---------------|-------------|------------------------------------|
| –ü—Ä–æ–±–ª–µ–º—ã —Å –º–∏–≥—Ä–∞—Ü–∏–µ–π –ë–î | –°—Ä–µ–¥–Ω—è—è       | –í—ã—Å–æ–∫–æ–µ     | –¢—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ staging |
| Performance –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è  | –ù–∏–∑–∫–∞—è        | –í—ã—Å–æ–∫–æ–µ     | Load testing –ø–µ—Ä–µ–¥ prod            |
| –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å v1    | –ù–∏–∑–∫–∞—è        | –°—Ä–µ–¥–Ω–µ–µ     | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ v1 –∏ v2        |
| Bugs –≤ —Ä–∞—Å—á–µ—Ç–∞—Ö         | –°—Ä–µ–¥–Ω—è—è       | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | 340 —Ç–µ—Å—Ç–æ–≤ + QA review             |

---

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ —Ä–µ–ª–∏–∑–∞

### Week 1
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫
- Hotfix –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å
- –°–±–æ—Ä feedback

### Month 1
- Weekly review
- Bug fixes
- Performance optimization

### Quarter 1
- Deprecate v1 API
- –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤
- Lessons learned

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–ª–∞–Ω –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–≠–¢–ê–ü 1)